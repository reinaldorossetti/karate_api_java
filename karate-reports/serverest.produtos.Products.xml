<testsuite failures="0" name="serverest/produtos/Products.feature" skipped="0" tests="16" time="5.819603"><testcase classname="serverest.produtos.Products" name="CT01 - List all products and validate JSON structure" time="0.426936"><system-out>* url 'https://serverest.dev' ............................................. passed
* def loginPayload = read('classpath:serverest/login/resources/loginPayload.json') . passed
Given path '/login' ....................................................... passed
And request loginPayload .................................................. passed
When method POST .......................................................... passed
Then status 200 ........................................................... passed
* def token = response.authorization ...................................... passed
* def randomName = function(){ return 'Product ' + new Date().getTime() } . passed
Given path '/produtos' .................................................... passed
When method GET ........................................................... passed
Then status 200 ........................................................... passed
And match response == ..................................................... passed
And match each response.produtos == ....................................... passed
And match each response.produtos contains { preco: '#number? _ &gt; 0' } ..... passed
And match each response.produtos contains { quantidade: '#number? _ &gt;= 0' } . passed
</system-out></testcase>
<testcase classname="serverest.produtos.Products" name="CT02 - Create a new product as an administrator" time="0.440831"><system-out>* url 'https://serverest.dev' ............................................. passed
* def loginPayload = read('classpath:serverest/login/resources/loginPayload.json') . passed
Given path '/login' ....................................................... passed
And request loginPayload .................................................. passed
When method POST .......................................................... passed
Then status 200 ........................................................... passed
* def token = response.authorization ...................................... passed
* def randomName = function(){ return 'Product ' + new Date().getTime() } . passed
* def productName = randomName() .......................................... passed
* def productData = ....................................................... passed
Given path '/produtos' .................................................... passed
And header Authorization = token .......................................... passed
And request productData ................................................... passed
When method POST .......................................................... passed
Then status 201 ........................................................... passed
And match response == ..................................................... passed
* def productId = response._id ............................................ passed
Given path '/produtos/' + productId ....................................... passed
When method GET ........................................................... passed
Then status 200 ........................................................... passed
And match response.nome == productName .................................... passed
And match response.preco == 250 ........................................... passed
And match response.quantidade == 100 ...................................... passed
</system-out></testcase>
<testcase classname="serverest.produtos.Products" name="CT03 - Validate error when creating a product with a duplicate name" time="0.382891"><system-out>* url 'https://serverest.dev' ............................................. passed
* def loginPayload = read('classpath:serverest/login/resources/loginPayload.json') . passed
Given path '/login' ....................................................... passed
And request loginPayload .................................................. passed
When method POST .......................................................... passed
Then status 200 ........................................................... passed
* def token = response.authorization ...................................... passed
* def randomName = function(){ return 'Product ' + new Date().getTime() } . passed
* def duplicateName = 'Duplicate Product Test ' + new Date().getTime() .... passed
* def product = ........................................................... passed
Given path '/produtos' .................................................... passed
And header Authorization = token .......................................... passed
And request product ....................................................... passed
When method POST .......................................................... passed
Then status 201 ........................................................... passed
Given path '/produtos' .................................................... passed
And header Authorization = token .......................................... passed
And request product ....................................................... passed
When method POST .......................................................... passed
Then status 400 ........................................................... passed
And match response == ..................................................... passed
</system-out></testcase>
<testcase classname="serverest.produtos.Products" name="CT04 - Search for products using query parameters" time="0.577464"><system-out>* url 'https://serverest.dev' ............................................. passed
* def loginPayload = read('classpath:serverest/login/resources/loginPayload.json') . passed
Given path '/login' ....................................................... passed
And request loginPayload .................................................. passed
When method POST .......................................................... passed
Then status 200 ........................................................... passed
* def token = response.authorization ...................................... passed
* def randomName = function(){ return 'Product ' + new Date().getTime() } . passed
Given path '/produtos' .................................................... passed
And param nome = 'Logitech' ............................................... passed
When method GET ........................................................... passed
Then status 200 ........................................................... passed
* def products = response.produtos ........................................ passed
* def allContainName = karate.filter(products, function(x){ return x.nome.includes('Logitech') }) . passed
And assert allContainName.length &gt; 0 ...................................... passed
Given path '/produtos' .................................................... passed
And param preco = 100 ..................................................... passed
When method GET ........................................................... passed
Then status 200 ........................................................... passed
</system-out></testcase>
<testcase classname="serverest.produtos.Products" name="CT05 - Update information of an existing product" time="0.495884"><system-out>* url 'https://serverest.dev' ............................................. passed
* def loginPayload = read('classpath:serverest/login/resources/loginPayload.json') . passed
Given path '/login' ....................................................... passed
And request loginPayload .................................................. passed
When method POST .......................................................... passed
Then status 200 ........................................................... passed
* def token = response.authorization ...................................... passed
* def randomName = function(){ return 'Product ' + new Date().getTime() } . passed
* def productName = randomName() .......................................... passed
* def initialProduct = .................................................... passed
Given path '/produtos' .................................................... passed
And header Authorization = token .......................................... passed
And request initialProduct ................................................ passed
When method POST .......................................................... passed
Then status 201 ........................................................... passed
* def productId = response._id ............................................ passed
* def updatedProduct = .................................................... passed
Given path '/produtos/' + productId ....................................... passed
And header Authorization = token .......................................... passed
And request updatedProduct ................................................ passed
When method PUT ........................................................... passed
Then status 200 ........................................................... passed
And match response.message == 'Registro alterado com sucesso' ............. passed
Given path '/produtos/' + productId ....................................... passed
When method GET ........................................................... passed
Then status 200 ........................................................... passed
And match response.preco == 200 ........................................... passed
And match response.descricao == 'Updated description' ..................... passed
And match response.quantidade == 75 ....................................... passed
</system-out></testcase>
<testcase classname="serverest.produtos.Products" name="CT06 - Validate price calculations and comparisons" time="0.251569"><system-out>* url 'https://serverest.dev' ............................................. passed
* def loginPayload = read('classpath:serverest/login/resources/loginPayload.json') . passed
Given path '/login' ....................................................... passed
And request loginPayload .................................................. passed
When method POST .......................................................... passed
Then status 200 ........................................................... passed
* def token = response.authorization ...................................... passed
* def randomName = function(){ return 'Product ' + new Date().getTime() } . passed
Given path '/produtos' .................................................... passed
When method GET ........................................................... passed
Then status 200 ........................................................... passed
* def products = response.produtos ........................................ passed
* def prices = karate.map(products, function(x){ return x.preco }) ........ passed
* def maxPrice = Math.max.apply(null, prices) ............................. passed
* print 'Highest Price:', maxPrice ........................................ passed
* def minPrice = Math.min.apply(null, prices) ............................. passed
* print 'Lowest Price:', minPrice ......................................... passed
* def sumPrices = prices.reduce(function(a, b){ return a + b }, 0) ........ passed
* def avgPrice = sumPrices / prices.length ................................ passed
* print 'Average Price:', avgPrice ........................................ passed
And match each products contains { preco: '#number? _ &gt; 0 &amp;&amp; _ &lt; 100000' } . passed
</system-out></testcase>
<testcase classname="serverest.produtos.Products" name="CT07 - Attempt to create a product without an authentication token" time="0.198596"><system-out>* url 'https://serverest.dev' ............................................. passed
* def loginPayload = read('classpath:serverest/login/resources/loginPayload.json') . passed
Given path '/login' ....................................................... passed
And request loginPayload .................................................. passed
When method POST .......................................................... passed
Then status 200 ........................................................... passed
* def token = response.authorization ...................................... passed
* def randomName = function(){ return 'Product ' + new Date().getTime() } . passed
* def product = ........................................................... passed
Given path '/produtos' .................................................... passed
And request product ....................................................... passed
When method POST .......................................................... passed
Then status 401 ........................................................... passed
And match response == ..................................................... passed
</system-out></testcase>
<testcase classname="serverest.produtos.Products" name="CT08 - Validate required fields when creating a product" time="0.209905"><system-out>* url 'https://serverest.dev' ............................................. passed
* def loginPayload = read('classpath:serverest/login/resources/loginPayload.json') . passed
Given path '/login' ....................................................... passed
And request loginPayload .................................................. passed
When method POST .......................................................... passed
Then status 200 ........................................................... passed
* def token = response.authorization ...................................... passed
* def randomName = function(){ return 'Product ' + new Date().getTime() } . passed
* def incompleteProduct = ................................................. passed
Given path '/produtos' .................................................... passed
And header Authorization = token .......................................... passed
And request incompleteProduct ............................................. passed
When method POST .......................................................... passed
Then status 400 ........................................................... passed
</system-out></testcase>
<testcase classname="serverest.produtos.Products" name="CT08 - Validate required fields when creating a product" time="0.153957"><system-out>* url 'https://serverest.dev' ............................................. passed
* def loginPayload = read('classpath:serverest/login/resources/loginPayload.json') . passed
Given path '/login' ....................................................... passed
And request loginPayload .................................................. passed
When method POST .......................................................... passed
Then status 200 ........................................................... passed
* def token = response.authorization ...................................... passed
* def randomName = function(){ return 'Product ' + new Date().getTime() } . passed
* def incompleteProduct = ................................................. passed
Given path '/produtos' .................................................... passed
And header Authorization = token .......................................... passed
And request incompleteProduct ............................................. passed
When method POST .......................................................... passed
Then status 400 ........................................................... passed
</system-out></testcase>
<testcase classname="serverest.produtos.Products" name="CT08 - Validate required fields when creating a product" time="0.165534"><system-out>* url 'https://serverest.dev' ............................................. passed
* def loginPayload = read('classpath:serverest/login/resources/loginPayload.json') . passed
Given path '/login' ....................................................... passed
And request loginPayload .................................................. passed
When method POST .......................................................... passed
Then status 200 ........................................................... passed
* def token = response.authorization ...................................... passed
* def randomName = function(){ return 'Product ' + new Date().getTime() } . passed
* def incompleteProduct = ................................................. passed
Given path '/produtos' .................................................... passed
And header Authorization = token .......................................... passed
And request incompleteProduct ............................................. passed
When method POST .......................................................... passed
Then status 400 ........................................................... passed
</system-out></testcase>
<testcase classname="serverest.produtos.Products" name="CT08 - Validate required fields when creating a product" time="0.160907"><system-out>* url 'https://serverest.dev' ............................................. passed
* def loginPayload = read('classpath:serverest/login/resources/loginPayload.json') . passed
Given path '/login' ....................................................... passed
And request loginPayload .................................................. passed
When method POST .......................................................... passed
Then status 200 ........................................................... passed
* def token = response.authorization ...................................... passed
* def randomName = function(){ return 'Product ' + new Date().getTime() } . passed
* def incompleteProduct = ................................................. passed
Given path '/produtos' .................................................... passed
And header Authorization = token .......................................... passed
And request incompleteProduct ............................................. passed
When method POST .......................................................... passed
Then status 400 ........................................................... passed
</system-out></testcase>
<testcase classname="serverest.produtos.Products" name="CT09 - Work with complex JSON data" time="0.173561"><system-out>* url 'https://serverest.dev' ............................................. passed
* def loginPayload = read('classpath:serverest/login/resources/loginPayload.json') . passed
Given path '/login' ....................................................... passed
And request loginPayload .................................................. passed
When method POST .......................................................... passed
Then status 200 ........................................................... passed
* def token = response.authorization ...................................... passed
* def randomName = function(){ return 'Product ' + new Date().getTime() } . passed
Given path '/produtos' .................................................... passed
When method GET ........................................................... passed
Then status 200 ........................................................... passed
* def cheapProducts = karate.filter(response.produtos, function(x){ return x.preco &lt; 100 }) . passed
* def mediumProducts = karate.filter(response.produtos, function(x){ return x.preco &gt;= 100 &amp;&amp; x.preco &lt; 500 }) . passed
* def expensiveProducts = karate.filter(response.produtos, function(x){ return x.preco &gt;= 500 }) . passed
* def grouping = .......................................................... passed
* print 'Cheap Products:', cheapProducts.length ........................... passed
* print 'Medium Products:', mediumProducts.length ......................... passed
* print 'Expensive Products:', expensiveProducts.length ................... passed
And match grouping contains { cheap: '#array', medium: '#array', expensive: '#array' } . passed
</system-out></testcase>
<testcase classname="serverest.produtos.Products" name="CT10 - Delete an existing product" time="0.577731"><system-out>* url 'https://serverest.dev' ............................................. passed
* def loginPayload = read('classpath:serverest/login/resources/loginPayload.json') . passed
Given path '/login' ....................................................... passed
And request loginPayload .................................................. passed
When method POST .......................................................... passed
Then status 200 ........................................................... passed
* def token = response.authorization ...................................... passed
* def randomName = function(){ return 'Product ' + new Date().getTime() } . passed
* def productName = randomName() .......................................... passed
* def product = ........................................................... passed
Given path '/produtos' .................................................... passed
And header Authorization = token .......................................... passed
And request product ....................................................... passed
When method POST .......................................................... passed
Then status 201 ........................................................... passed
* def productId = response._id ............................................ passed
Given path '/produtos/' + productId ....................................... passed
And header Authorization = token .......................................... passed
When method DELETE ........................................................ passed
Then status 200 ........................................................... passed
And match response.message == 'Registro excluído com sucesso' ............. passed
Given path '/produtos/' + productId ....................................... passed
When method GET ........................................................... passed
Then status 400 ........................................................... passed
And match response.message == 'Produto não encontrado' .................... passed
</system-out></testcase>
<testcase classname="serverest.produtos.Products" name="CT11 - Create a product from fixed JSON payload" time="0.194413"><system-out>* url 'https://serverest.dev' ............................................. passed
* def loginPayload = read('classpath:serverest/login/resources/loginPayload.json') . passed
Given path '/login' ....................................................... passed
And request loginPayload .................................................. passed
When method POST .......................................................... passed
Then status 200 ........................................................... passed
* def token = response.authorization ...................................... passed
* def randomName = function(){ return 'Product ' + new Date().getTime() } . passed
* def productPayload = read('resources/productPayload.json') .............. passed
* set productPayload.nome = randomName() .................................. passed
Given path '/produtos' .................................................... passed
And header Authorization = token .......................................... passed
And request productPayload ................................................ passed
When method POST .......................................................... passed
Then status 201 ........................................................... passed
And match response.message == 'Cadastro realizado com sucesso' ............ passed
And match response._id == '#string' ....................................... passed
</system-out></testcase>
<testcase classname="serverest.produtos.Products" name="CT12 - Prevent deleting a product that is part of a cart" time="0.87802"><system-out>* url 'https://serverest.dev' ............................................. passed
* def loginPayload = read('classpath:serverest/login/resources/loginPayload.json') . passed
Given path '/login' ....................................................... passed
And request loginPayload .................................................. passed
When method POST .......................................................... passed
Then status 200 ........................................................... passed
* def token = response.authorization ...................................... passed
* def randomName = function(){ return 'Product ' + new Date().getTime() } . passed
* def productName = randomName() .......................................... passed
* def product = ........................................................... passed
Given path '/produtos' .................................................... passed
And header Authorization = token .......................................... passed
And request product ....................................................... passed
When method POST .......................................................... passed
Then status 201 ........................................................... passed
* def productId = response._id ............................................ passed
* def userEmail = 'cart.user.' + new Date().getTime() + '@example.com' .... passed
* def userPassword = 'SenhaSegura@123' .................................... passed
* def userData = .......................................................... passed
Given path '/usuarios' .................................................... passed
And request userData ...................................................... passed
When method POST .......................................................... passed
Then status 201 ........................................................... passed
* def loginPayload = ...................................................... passed
Given path '/login' ....................................................... passed
And request loginPayload .................................................. passed
When method POST .......................................................... passed
Then status 200 ........................................................... passed
* def userToken = response.authorization .................................. passed
Given path '/carrinhos/cancelar-compra' ................................... passed
And header Authorization = userToken ...................................... passed
When method DELETE ........................................................ passed
Then status 200 ........................................................... passed
* def cartBody = .......................................................... passed
Given path '/carrinhos' ................................................... passed
And header Authorization = userToken ...................................... passed
And request cartBody ...................................................... passed
When method POST .......................................................... passed
Then status 201 ........................................................... passed
Given path '/produtos/' + productId ....................................... passed
And header Authorization = token .......................................... passed
When method DELETE ........................................................ passed
Then status 400 ........................................................... passed
And match response.message == 'Não é permitido excluir produto que faz parte de carrinho' . passed
</system-out></testcase>
<testcase classname="serverest.produtos.Products" name="CT13 - Restrict product creation to administrators only" time="0.531403"><system-out>* url 'https://serverest.dev' ............................................. passed
* def loginPayload = read('classpath:serverest/login/resources/loginPayload.json') . passed
Given path '/login' ....................................................... passed
And request loginPayload .................................................. passed
When method POST .......................................................... passed
Then status 200 ........................................................... passed
* def token = response.authorization ...................................... passed
* def randomName = function(){ return 'Product ' + new Date().getTime() } . passed
* def userEmail = 'non.admin.' + new Date().getTime() + '@example.com' .... passed
* def userPassword = 'SenhaSegura@123' .................................... passed
* def userData = .......................................................... passed
Given path '/usuarios' .................................................... passed
And request userData ...................................................... passed
When method POST .......................................................... passed
Then status 201 ........................................................... passed
* def loginPayload = ...................................................... passed
Given path '/login' ....................................................... passed
And request loginPayload .................................................. passed
When method POST .......................................................... passed
Then status 200 ........................................................... passed
* def nonAdminToken = response.authorization .............................. passed
* def productData = ....................................................... passed
Given path '/produtos' .................................................... passed
And header Authorization = nonAdminToken .................................. passed
And request productData ................................................... passed
When method POST .......................................................... passed
Then status 403 ........................................................... passed
And match response.message == 'Rota exclusiva para administradores' ....... passed
</system-out></testcase>
</testsuite>