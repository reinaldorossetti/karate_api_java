# ğŸ¥‹ Karate API Testing - ServeRest

[![Karate](https://img.shields.io/badge/Karate-1.5.0-blue.svg)](https://github.com/karatelabs/karate)
[![JUnit5](https://img.shields.io/badge/JUnit-5.10.1-green.svg)](https://junit.org/junit5/)
[![Java](https://img.shields.io/badge/Java-17-orange.svg)](https://www.oracle.com/java/)

Projeto de automaÃ§Ã£o de testes de API utilizando **Karate Framework** para testar a API REST **ServeRest** - uma API gratuita que simula uma loja virtual.

---

## ğŸ“š Ãndice

- [Sobre o Karate Framework](#-sobre-o-karate-framework)
- [Sobre a API ServeRest](#-sobre-a-api-serverest)
- [Estrutura do Projeto](#-estrutura-do-projeto)
- [PrÃ©-requisitos](#-prÃ©-requisitos)
- [InstalaÃ§Ã£o](#-instalaÃ§Ã£o)
- [Executando os Testes](#-executando-os-testes)
- [Exemplos de Testes](#-exemplos-de-testes)
- [Funcionalidades do Karate](#-funcionalidades-do-karate)
- [RelatÃ³rios](#-relatÃ³rios)
- [Boas PrÃ¡ticas](#-boas-prÃ¡ticas)
- [Recursos Adicionais](#-recursos-adicionais)

---

## ğŸ¥‹ Sobre o Karate Framework

**Karate** Ã© um framework open-source que unifica testes de API, mocks, testes de performance e atÃ© mesmo automaÃ§Ã£o de UI em uma Ãºnica estrutura poderosa e fÃ¡cil de usar.

### âœ¨ Principais CaracterÃ­sticas

- **ğŸ”¥ Sem necessidade de cÃ³digo Java**: Escreva testes usando uma sintaxe simples baseada em Gherkin
- **ğŸš€ Testes de API REST e SOAP**: Suporte completo para HTTP, JSON, XML, GraphQL
- **ğŸ¯ Built-in para Assertions**: ValidaÃ§Ãµes poderosas e expressivas sem bibliotecas adicionais
- **ğŸ”„ ReutilizaÃ§Ã£o de cÃ³digo**: Chamadas entre features, funÃ§Ãµes JavaScript customizadas
- **ğŸ“Š RelatÃ³rios HTML**: RelatÃ³rios detalhados e visuais automaticamente gerados
- **ğŸ§ª Data-Driven Testing**: Suporte nativo para testes orientados a dados
- **ğŸ­ Mock Server**: Crie mocks de APIs facilmente
- **âš¡ ExecuÃ§Ã£o Paralela**: Execute testes em paralelo para maior velocidade
- **ğŸ” AutenticaÃ§Ã£o**: Suporte para OAuth, JWT, cookies e headers customizados

### ğŸ’¡ Por que usar Karate?

1. **Produtividade**: Escreva testes complexos de forma simples e legÃ­vel
2. **Manutenibilidade**: Testes fÃ¡ceis de entender e manter
3. **Completude**: Tudo que vocÃª precisa em um Ãºnico framework
4. **Comunidade ativa**: Bem documentado e com suporte ativo
5. **IntegraÃ§Ã£o CI/CD**: FÃ¡cil integraÃ§Ã£o com Jenkins, GitLab CI, GitHub Actions, etc.

---

## ğŸŒ Sobre a API ServeRest

[ServeRest](https://serverest.dev/) Ã© uma API REST gratuita que simula uma loja virtual, criada por [Paulo GonÃ§alves](https://github.com/PauloGoncalvesBH) para fins educacionais e prÃ¡tica de testes de API.

### ğŸ›ï¸ Endpoints DisponÃ­veis

| Recurso | Endpoints | DescriÃ§Ã£o |
|---------|-----------|-----------|
| **Login** | `POST /login` | AutenticaÃ§Ã£o de usuÃ¡rios |
| **UsuÃ¡rios** | `GET, POST, PUT, DELETE /usuarios` | Gerenciamento de usuÃ¡rios |
| **Produtos** | `GET, POST, PUT, DELETE /produtos` | Gerenciamento de produtos (requer admin) |
| **Carrinhos** | `GET, POST, DELETE /carrinhos` | Gerenciamento de carrinhos de compras |

### ğŸ”— Base URL

```
https://serverest.dev
```

### ğŸ“– DocumentaÃ§Ã£o Completa

- **Swagger UI**: https://serverest.dev/
- **RepositÃ³rio**: https://github.com/ServeRest/ServeRest
- **Front-end (Beta)**: https://front.serverest.dev/

---

## ğŸ“ Estrutura do Projeto

```
karate_api_java/
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â””â”€â”€ java/
â”‚   â”‚       â””â”€â”€ com/intuit/karate/junit5/
â”‚   â”‚           â”œâ”€â”€ FeatureNode.java
â”‚   â”‚           â””â”€â”€ Karate.java
â”‚   â”‚
â”‚   â””â”€â”€ test/
â”‚       â””â”€â”€ java/
â”‚           â”œâ”€â”€ karate-config.js          # ConfiguraÃ§Ã£o global do Karate
â”‚           â”œâ”€â”€ logback-test.xml          # ConfiguraÃ§Ã£o de logs
â”‚           â”‚
â”‚           â”œâ”€â”€ karate/                   # Exemplos bÃ¡sicos do Karate
â”‚           â”‚   â”œâ”€â”€ sample.feature
â”‚           â”‚   â”œâ”€â”€ SampleTest.java
â”‚           â”‚   â”œâ”€â”€ customTags.feature
â”‚           â”‚   â””â”€â”€ ...
â”‚           â”‚
â”‚           â””â”€â”€ serverest/                # Testes da API ServeRest
â”‚               â”œâ”€â”€ usuarios/
â”‚               â”‚   â”œâ”€â”€ usuarios.feature
â”‚               â”‚   â””â”€â”€ UsuariosTest.java
â”‚               â”œâ”€â”€ produtos/
â”‚               â”‚   â”œâ”€â”€ produtos.feature
â”‚               â”‚   â””â”€â”€ ProdutosTest.java
â”‚               â”œâ”€â”€ login/
â”‚               â”‚   â”œâ”€â”€ login.feature
â”‚               â”‚   â””â”€â”€ LoginTest.java
â”‚               â””â”€â”€ carrinhos/
â”‚                   â”œâ”€â”€ carrinhos.feature
â”‚                   â””â”€â”€ CarrinhosTest.java
â”‚
â”œâ”€â”€ pom.xml                               # Maven dependencies
â””â”€â”€ README.md                             # Este arquivo
```

---

## ğŸ”§ PrÃ©-requisitos

- **Java JDK 17** ou superior
- **Maven 3.6+**
- **IDE** (IntelliJ IDEA, Eclipse, VS Code)
- ConexÃ£o com internet (para acessar a API ServeRest)

### Verificar instalaÃ§Ã£o

```bash
java -version
mvn -version
```

---

## ğŸš€ InstalaÃ§Ã£o

### 1. Clone o repositÃ³rio

```bash
git clone https://github.com/seu-usuario/karate_api_java.git
cd karate_api_java
```

### 2. Instale as dependÃªncias

```bash
mvn clean install
```

### 3. Verifique a instalaÃ§Ã£o

```bash
mvn test
```

---

## â–¶ï¸ Executando os Testes

### Executar todos os testes

```bash
mvn test
```

### Executar um teste especÃ­fico

```bash
mvn test -Dtest=UsuariosTest
```

### Executar por tags

```bash
mvn test -Dkarate.options="--tags @smoke"
```

### Executar com diferentes ambientes

```bash
mvn test -Dkarate.env=dev
mvn test -Dkarate.env=prod
```

### Executar em paralelo

```bash
mvn test -Dkarate.options="--threads 5"
```

---

## ğŸ“ Exemplos de Testes

### Exemplo 1: Listar UsuÃ¡rios (GET)

**Feature**: `src/test/java/serverest/usuarios/usuarios.feature`

```gherkin
@usuarios
Feature: Gerenciamento de UsuÃ¡rios

  Background:
    * url baseUrl + '/usuarios'

  @listar @smoke
  Scenario: Listar todos os usuÃ¡rios
    Given path ''
    When method GET
    Then status 200
    And match response.quantidade == '#number'
    And match response.usuarios == '#array'
```

### Exemplo 2: Cadastrar UsuÃ¡rio (POST)

```gherkin
  @cadastrar
  Scenario: Cadastrar novo usuÃ¡rio com sucesso
    * def randomEmail = 'teste' + karate.randomString(5) + '@email.com'
    Given path ''
    And request
      """
      {
        "nome": "Fulano da Silva",
        "email": "#(randomEmail)",
        "password": "senha123",
        "administrador": "true"
      }
      """
    When method POST
    Then status 201
    And match response.message == 'Cadastro realizado com sucesso'
    And match response._id == '#string'
    * def userId = response._id
```

### Exemplo 3: Login e AutenticaÃ§Ã£o

```gherkin
@login
Feature: AutenticaÃ§Ã£o de UsuÃ¡rios

  Background:
    * url baseUrl + '/login'

  @login-sucesso
  Scenario: Realizar login com credenciais vÃ¡lidas
    Given path ''
    And request
      """
      {
        "email": "fulano@qa.com",
        "password": "teste"
      }
      """
    When method POST
    Then status 200
    And match response.message == 'Login realizado com sucesso'
    And match response.authorization == '#string'
    * def token = response.authorization
```

### Exemplo 4: Testes com AutenticaÃ§Ã£o (Produtos)

```gherkin
@produtos
Feature: Gerenciamento de Produtos (Requer AutenticaÃ§Ã£o)

  Background:
    * url baseUrl
    # Realizar login primeiro
    * def loginResponse = call read('classpath:serverest/login/login.feature@login-sucesso')
    * def token = loginResponse.token
    * path '/produtos'

  @cadastrar-produto
  Scenario: Cadastrar produto como administrador
    * def randomName = 'Produto ' + karate.randomString(5)
    Given path ''
    And header Authorization = token
    And request
      """
      {
        "nome": "#(randomName)",
        "preco": 470,
        "descricao": "Produto de teste",
        "quantidade": 381
      }
      """
    When method POST
    Then status 201
    And match response.message == 'Cadastro realizado com sucesso'
```

### Exemplo 5: Data-Driven Testing

```gherkin
  @validacao-email
  Scenario Outline: Validar cadastro com emails invÃ¡lidos
    Given path ''
    And request
      """
      {
        "nome": "Teste",
        "email": "<email>",
        "password": "senha123",
        "administrador": "true"
      }
      """
    When method POST
    Then status 400

    Examples:
      | email           |
      | email.invalido  |
      | @email.com      |
      | email@          |
      | email           |
```

### Exemplo 6: Schema Validation

```gherkin
  @validacao-schema
  Scenario: Validar estrutura da resposta ao listar usuÃ¡rios
    Given path ''
    When method GET
    Then status 200
    And match response ==
      """
      {
        quantidade: '#number',
        usuarios: '#[] #object'
      }
      """
    And match each response.usuarios ==
      """
      {
        nome: '#string',
        email: '#string',
        password: '#string',
        administrador: '#string',
        _id: '#string'
      }
      """
```

---

## ğŸ¯ Funcionalidades do Karate

### 1. ConfiguraÃ§Ã£o Global (karate-config.js)

```javascript
function fn() {
  var config = {
    baseUrl: 'https://serverest.dev',
    timeout: 10000
  };
  
  // ConfiguraÃ§Ã£o por ambiente
  var env = karate.env;
  if (env === 'dev') {
    config.baseUrl = 'http://localhost:3000';
  } else if (env === 'prod') {
    config.baseUrl = 'https://serverest.dev';
  }
  
  return config;
}
```

### 2. Assertions Poderosas

```gherkin
# Validar tipo
And match response.quantidade == '#number'

# Validar array
And match response.usuarios == '#array'

# Validar cada item do array
And match each response.usuarios contains { nome: '#string' }

# Validar com regex
And match response.email == '#regex .+@.+\\..+'

# Validar presenÃ§a de campos
And match response contains { message: '#string', _id: '#string' }

# Validar ausÃªncia de campo
And match response !contains { error: '#string' }
```

### 3. VariÃ¡veis e ReutilizaÃ§Ã£o

```gherkin
# Definir variÃ¡vel
* def userId = response._id

# String concatenation
* def fullUrl = baseUrl + '/usuarios/' + userId

# Random data
* def randomEmail = 'teste' + karate.randomString(5) + '@email.com'

# Chamar outra feature
* def loginResult = call read('login.feature')
* def token = loginResult.token
```

### 4. Hooks e Setup

```gherkin
Background:
  * url baseUrl
  * configure headers = { 'Content-Type': 'application/json' }
  * configure connectTimeout = 5000
  * configure readTimeout = 5000
```

---

## ğŸ“Š RelatÃ³rios

ApÃ³s executar os testes, relatÃ³rios HTML sÃ£o gerados automaticamente:

```
target/karate-reports/karate-summary.html
```

Abra o arquivo no navegador para visualizar:
- âœ… Testes executados, passados e falhos
- â±ï¸ Tempo de execuÃ§Ã£o
- ğŸ“¸ Screenshots (se configurado)
- ğŸ“‹ Logs detalhados de cada cenÃ¡rio

---

## ğŸ“ Boas PrÃ¡ticas

### 1. OrganizaÃ§Ã£o de Features

- âœ… Uma feature por recurso (usuarios.feature, produtos.feature)
- âœ… Use Background para configuraÃ§Ãµes comuns
- âœ… Nomeie scenarios de forma descritiva

### 2. Tags para OrganizaÃ§Ã£o

```gherkin
@smoke     # Testes crÃ­ticos de smoke
@regression # Suite de regressÃ£o completa
@usuarios   # Testes de usuÃ¡rios
@ignore    # Temporariamente desabilitado
```

### 3. ReutilizaÃ§Ã£o de CÃ³digo

- âœ… Crie features reutilizÃ¡veis (ex: login.feature)
- âœ… Use funÃ§Ãµes JavaScript no karate-config.js
- âœ… Extraia dados comuns para variÃ¡veis

### 4. Dados de Teste

```gherkin
# Gerar dados dinÃ¢micos
* def timestamp = new Date().getTime()
* def randomEmail = 'user' + timestamp + '@test.com'

# Evitar dados estÃ¡ticos que podem causar conflitos
```

### 5. ValidaÃ§Ãµes Completas

```gherkin
# Sempre valide:
- Status code
- Schema da resposta
- Mensagens de erro
- Headers importantes
```

---

## ğŸ“š Recursos Adicionais

### DocumentaÃ§Ã£o Oficial

- ğŸ¥‹ **Karate**: https://github.com/karatelabs/karate
- ğŸŒ **ServeRest**: https://serverest.dev/
- â˜• **JUnit 5**: https://junit.org/junit5/

### Tutoriais e Cursos

- [Karate DSL Official Documentation](https://karatelabs.github.io/karate/)
- [Karate Examples on GitHub](https://github.com/karatelabs/karate/tree/master/karate-demo)
- [ServeRest GitHub](https://github.com/ServeRest/ServeRest)

### Comunidade

- [Karate Slack Community](https://karate-dsl.slack.com)
- [Stack Overflow - Karate Tag](https://stackoverflow.com/questions/tagged/karate)

---

## ğŸ¤ Contribuindo

ContribuiÃ§Ãµes sÃ£o bem-vindas! Para contribuir:

1. Fork o projeto
2. Crie uma branch para sua feature (`git checkout -b feature/MinhaFeature`)
3. Commit suas mudanÃ§as (`git commit -m 'Adiciona nova feature'`)
4. Push para a branch (`git push origin feature/MinhaFeature`)
5. Abra um Pull Request

---

## ğŸ“„ LicenÃ§a

Este projeto estÃ¡ sob a licenÃ§a MIT. Veja o arquivo [LICENSE](LICENSE) para mais detalhes.

---

## ğŸ‘¨â€ğŸ’» Autor

Desenvolvido para fins de estudo e prÃ¡tica de automaÃ§Ã£o de testes de API.

---

## â­ Agradecimentos

- **Paulo GonÃ§alves** - Criador da API ServeRest
- **Peter Thomas** - Criador do Karate Framework
- Comunidade open-source

---

**ğŸš€ Happy Testing!** ğŸ¥‹
