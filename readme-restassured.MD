# ğŸ§ª Rest Assured API Testing - ServeRest

[![RestAssured](https://img.shields.io/badge/RestAssured-5.3.2-blue.svg)](https://rest-assured.io/)
[![JUnit5](https://img.shields.io/badge/JUnit-5.10.1-green.svg)](https://junit.org/junit5/)
[![Java](https://img.shields.io/badge/Java-21-orange.svg)](https://www.oracle.com/java/)

Projeto de automaÃ§Ã£o de testes de API utilizando **Rest Assured** para testar a API REST **ServeRest** - uma API gratuita que simula uma loja virtual.

Projeto estruturado com boas prÃ¡ticas, exemplos de testes, validaÃ§Ãµes avanÃ§adas e integraÃ§Ã£o com JUnit 5 para execuÃ§Ã£o e relatÃ³rios.

URI do repositÃ³rio: [https://github.com/reinaldorossetti/karate_api_java](https://github.com/reinaldorossetti/karate_api_java)

Reporte na esteira: [https://reinaldorossetti.github.io/karate_api_java/allure-reports/index.html](https://reinaldorossetti.github.io/karate_api_java/allure-reports/index.html)

Testes realizados na API: [TESTING_API.MD](TESTING_API.MD)

---

## ğŸ“š Ãndice

- [Sobre o Rest Assured](#-sobre-o-rest-assured)
- [Sobre a API ServeRest](#-sobre-a-api-serverest)
- [Estrutura do Projeto](#-estrutura-do-projeto)
- [PrÃ©-requisitos](#-prÃ©-requisitos)
- [InstalaÃ§Ã£o](#-instalaÃ§Ã£o)
- [Executando os Testes](#-executando-os-testes)
- [Exemplos de Testes](#-exemplos-de-testes)
- [Funcionalidades do Rest Assured](#-funcionalidades-do-rest-assured)
- [RelatÃ³rios](#-relatÃ³rios)
- [Boas PrÃ¡ticas](#-boas-prÃ¡ticas)
- [Recursos Adicionais](#-recursos-adicionais)

---

## ğŸ§ª Sobre o Rest Assured

**Rest Assured** Ã© uma biblioteca Java open-source amplamente utilizada para testes de APIs REST. Oferece uma DSL fluente e expressiva para escrever testes robustos com validaÃ§Ãµes poderosas.

### âœ¨ Principais CaracterÃ­sticas

- **ğŸ”¥ DSL Fluente**: Sintaxe `given().when().then()` intuitiva e legÃ­vel
- **ğŸš€ Suporte completo a REST**: GET, POST, PUT, PATCH, DELETE com JSON/XML
- **ğŸ¯ Assertions com Hamcrest**: ValidaÃ§Ãµes poderosas e expressivas nativas
- **ğŸ”„ ReutilizaÃ§Ã£o com RequestSpec**: EspecificaÃ§Ãµes reutilizÃ¡veis de requisiÃ§Ã£o e resposta
- **ğŸ“Š IntegraÃ§Ã£o com Allure**: RelatÃ³rios detalhados e visuais com `givenWithAllure()`
- **ğŸ§ª Data-Driven Testing**: Suporte nativo via `@CsvFileSource`, `@MethodSource`
- **âš¡ ExecuÃ§Ã£o Paralela**: Suporte via `@Execution(CONCURRENT)` do JUnit 5
- **ğŸ” AutenticaÃ§Ã£o**: Suporte para OAuth2, JWT, Basic Auth e headers customizados

### ğŸ’¡ Por que usar Rest Assured?

1. **Produtividade**: DSL fluente reduz verbosidade em comparaÃ§Ã£o ao HttpClient puro
2. **Manutenibilidade**: Testes legÃ­veis e fÃ¡ceis de manter
3. **IntegraÃ§Ã£o**: Funciona nativamente com JUnit 5, TestNG e Maven
4. **Comunidade ativa**: Amplamente adotado no mercado e bem documentado
5. **CI/CD**: FÃ¡cil integraÃ§Ã£o com Jenkins, GitLab CI, GitHub Actions

---

## ğŸŒ Sobre a API ServeRest

[ServeRest](https://serverest.dev/) Ã© uma API REST gratuita que simula uma loja virtual para fins educacionais e prÃ¡tica de testes de API.

### ğŸ›ï¸ Endpoints DisponÃ­veis

| Recurso | Endpoints | DescriÃ§Ã£o |
|---------|-----------|-----------|
| **Login** | `POST /login` | AutenticaÃ§Ã£o de usuÃ¡rios |
| **UsuÃ¡rios** | `GET, POST, PUT, DELETE /usuarios` | Gerenciamento de usuÃ¡rios |
| **Produtos** | `GET, POST, PUT, DELETE /produtos` | Gerenciamento de produtos (requer admin) |
| **Carrinhos** | `GET, POST, DELETE /carrinhos` | Gerenciamento de carrinhos de compras |

### ğŸ”— Base URL

```
https://serverest.dev
```

### ğŸ“– DocumentaÃ§Ã£o Completa

- **Swagger UI**: https://serverest.dev/
- **RepositÃ³rio**: https://github.com/ServeRest/ServeRest
- **Front-end (Beta)**: https://front.serverest.dev/

---

## ğŸ“ Estrutura do Projeto

```
karate_api_java/
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â””â”€â”€ java/                         # (vazio neste projeto)
â”‚   â”‚
â”‚   â””â”€â”€ test/
â”‚       â”œâ”€â”€ java/
â”‚       â”‚   â””â”€â”€ restassured/
â”‚       â”‚       â”œâ”€â”€ base/
â”‚       â”‚       â”‚   â””â”€â”€ BaseApiTest.java        # ConfiguraÃ§Ã£o base (RequestSpec, BaseURI)
â”‚       â”‚       â”œâ”€â”€ login/
â”‚       â”‚       â”‚   â””â”€â”€ LoginRestAssuredTest.java
â”‚       â”‚       â”œâ”€â”€ usuarios/
â”‚       â”‚       â”‚   â””â”€â”€ UsuariosRestAssuredTest.java
â”‚       â”‚       â”œâ”€â”€ produtos/
â”‚       â”‚       â”‚   â””â”€â”€ ProdutosRestAssuredTest.java
â”‚       â”‚       â””â”€â”€ utils/
â”‚       â”‚           â””â”€â”€ FakerUtils.java
â”‚       â”‚
â”‚       â””â”€â”€ resources/
â”‚           â”œâ”€â”€ restassured/
â”‚           â”‚   â””â”€â”€ login/
â”‚           â”‚       â””â”€â”€ invalid-login-emails.csv
â”‚           â””â”€â”€ junit-platform.properties
â”‚
â”œâ”€â”€ pom.xml                               # DependÃªncias Maven
â””â”€â”€ README.md                             # Este arquivo
```

---

## ğŸ”§ PrÃ©-requisitos

- **Java JDK 21** (LTS) ou superior
- **Maven 3.6+**
- **IDE** (IntelliJ IDEA, Eclipse, VS Code)
- ConexÃ£o com internet (para acessar a API ServeRest)

### Download do Java 21

- Oracle JDK 21: https://www.oracle.com/java/technologies/downloads/#java21

### Verificar instalaÃ§Ã£o

```bash
java -version
mvn -version
```

---

## ğŸ“¦ VersÃµes das dependÃªncias (pom.xml)

| Componente                         | Artefato                                           | VersÃ£o  |
|------------------------------------|----------------------------------------------------|---------|
| Rest Assured                       | io.rest-assured:rest-assured                       | 5.3.2   |
| Rest Assured JSON Path             | io.rest-assured:json-path                          | 5.3.2   |
| Allure Rest Assured                | io.qameta.allure:allure-rest-assured               | 2.24.0  |
| JUnit 5 (Jupiter API)             | org.junit.jupiter:junit-jupiter-api                | 5.10.1  |
| JUnit 5 (Jupiter Engine)          | org.junit.jupiter:junit-jupiter-engine             | 5.10.1  |
| JUnit 5 (Jupiter Params)          | org.junit.jupiter:junit-jupiter-params             | 5.10.1  |
| Hamcrest                           | org.hamcrest:hamcrest                              | 2.2     |
| Java Faker                         | com.github.javafaker:javafaker                     | 1.0.2   |
| Maven Surefire Plugin             | org.apache.maven.plugins:maven-surefire-plugin     | 3.2.5   |
| Maven Compiler Plugin             | org.apache.maven.plugins:maven-compiler-plugin     | 3.11.0  |

---

## ğŸš€ InstalaÃ§Ã£o

### 1. Clone o repositÃ³rio

```bash
git clone https://github.com/reinaldorossetti/karate_api_java.git
cd karate_api_java
```

### 2. Instale as dependÃªncias

```bash
mvn clean install
```

### 3. Verifique a instalaÃ§Ã£o

```bash
mvn test
```

---

## â–¶ï¸ Executando os Testes

### Executar todos os testes do projeto restassured.

```bash
mvn clean test -Dtest=restassured.**.*Test
```

### Executar suÃ­te de login

```bash
mvn -Dtest=LoginRestAssuredTest test
```

### Executar mÃ©todo especÃ­fico

```bash
mvn -Dtest=LoginRestAssuredTest#ct01_loginWithValidCredentials test
```

### ExecuÃ§Ã£o paralela (JUnit 5)

Arquivo: `src/test/resources/junit-platform.properties`

```properties
junit.jupiter.execution.parallel.enabled=true
junit.jupiter.execution.parallel.mode.default=concurrent
junit.jupiter.execution.parallel.mode.classes.default=concurrent
junit.jupiter.execution.parallel.config.strategy=dynamic
junit.jupiter.execution.parallel.config.dynamic.factor=2
```

---

## âš™ï¸ Esteira CI/CD - GitHub Actions

Este projeto possui integraÃ§Ã£o contÃ­nua configurada no GitHub Actions em:

- Arquivo: `.github/workflows/api-tests.yml`

### ğŸ” Quando a esteira Ã© executada

- `push` em qualquer branch
- `pull_request` aberto ou atualizado

### ğŸ§± Passos principais do job `test`

1. **Checkout do cÃ³digo**
   - `actions/checkout@v4`
2. **ConfiguraÃ§Ã£o do Java 21**
   - `actions/setup-java@v5` com:
     - `java-version: '21'`
     - `distribution: 'temurin'`
3. **ExecuÃ§Ã£o dos testes via Maven**
   - Comando: `mvn clean -Dtest=ExecutionBuilderRunner test`
4. **PublicaÃ§Ã£o de relatÃ³rios Allure**
   - Publica `target/allure-report` via `peaceiris/actions-gh-pages@v4` na branch `gh-pages`, pasta `allure-reports`.

### ğŸŒ Acesso ao relatÃ³rio no GitHub Pages

ApÃ³s a execuÃ§Ã£o da esteira:

- URL do relatÃ³rio:
  - `https://reinaldorossetti.github.io/karate_api_java/allure-reports/index.html`

---

## ğŸ“ Exemplos de Testes

### Exemplo 1: ConfiguraÃ§Ã£o Base (BaseApiTest)

```java
public class BaseApiTest {

    @BeforeAll
    static void setup() {
        RestAssured.baseURI = "https://serverest.dev";
        RestAssured.requestSpecification = new RequestSpecBuilder()
                .setContentType(ContentType.JSON)
                .build();
    }

    protected RequestSpecification givenWithAllure() {
        return given()
                .filter(new AllureRestAssured());
    }
}
```

### Exemplo 2: Login com sucesso (GET/POST)

```java
@Test
@DisplayName("CT01 - Login com credenciais vÃ¡lidas e validaÃ§Ã£o de token")
void ct01_loginWithValidCredentials() {
    String email = FakerUtils.randomEmail();
    String password = "SenhaSegura@123";

    // Cria usuÃ¡rio
    givenWithAllure()
        .body("{\"nome\":\"Teste\",\"email\":\"" + email + "\",\"password\":\"" + password + "\",\"administrador\":\"true\"}")
    .when()
        .post("/usuarios")
    .then()
        .statusCode(201);

    // Realiza login
    givenWithAllure()
        .basePath("/login")
        .body("{\"email\":\"" + email + "\",\"password\":\"" + password + "\"}")
    .when()
        .post()
    .then()
        .statusCode(200)
        .body("message", equalTo("Login realizado com sucesso"))
        .body("authorization", notNullValue());
}
```

### Exemplo 3: Login invÃ¡lido

```java
@Test
@DisplayName("CT02 - Login com credenciais invÃ¡lidas")
void ct02_loginWithInvalidCredentials() {
    givenWithAllure()
        .basePath("/login")
        .body("{\"email\":\"invalido@teste.com\",\"password\":\"senhaerrada\"}")
    .when()
        .post()
    .then()
        .statusCode(401)
        .body("message", equalTo("Email e/ou senha invÃ¡lidos"))
        .body("authorization", nullValue());
}
```

### Exemplo 4: ValidaÃ§Ã£o de campos obrigatÃ³rios

```java
@Test
@DisplayName("CT03 - ValidaÃ§Ã£o de campos obrigatÃ³rios no login")
void ct03_validateRequiredFields() {
    // Email vazio
    givenWithAllure()
        .basePath("/login")
        .body("{\"email\":\"\",\"password\":\"senha123\"}")
    .when()
        .post()
    .then()
        .statusCode(400)
        .body("email", notNullValue());

    // Senha vazia
    givenWithAllure()
        .basePath("/login")
        .body("{\"email\":\"test@email.com\",\"password\":\"\"}")
    .when()
        .post()
    .then()
        .statusCode(400)
        .body("password", notNullValue());
}
```

### Exemplo 5: Uso do token em rota protegida

```java
@Test
@DisplayName("CT04 - Login e uso de token em rota protegida")
void ct04_loginAndUseTokenInProtectedRoute() {
    String email = FakerUtils.randomEmail();
    String password = "SenhaSegura@123";

    // Cria usuÃ¡rio comum (nÃ£o admin)
    givenWithAllure()
        .body("{\"nome\":\"Teste\",\"email\":\"" + email + "\",\"password\":\"" + password + "\",\"administrador\":\"false\"}")
    .when()
        .post("/usuarios")
    .then()
        .statusCode(201);

    // Extrai token
    String token = givenWithAllure()
        .basePath("/login")
        .body("{\"email\":\"" + email + "\",\"password\":\"" + password + "\"}")
    .when()
        .post()
    .then()
        .statusCode(200)
        .extract().path("authorization");

    // Tenta criar produto sem permissÃ£o de admin
    givenWithAllure()
        .header("Authorization", token)
        .basePath("/produtos")
        .body("{\"nome\":\"Produto Teste\",\"preco\":100,\"descricao\":\"Teste\",\"quantidade\":10}")
    .when()
        .post()
    .then()
        .statusCode(403)
        .body("message", equalTo("Rota exclusiva para administradores"));
}
```

### Exemplo 6: Teste parametrizado com CSV

```java
@ParameterizedTest(name = "CT05 - Email invÃ¡lido: {0}")
@CsvFileSource(resources = "/restassured/login/invalid-login-emails.csv", numLinesToSkip = 1)
@Execution(ExecutionMode.CONCURRENT)
@DisplayName("CT05 - ValidaÃ§Ã£o de formato de e-mail invÃ¡lido")
void ct05_validateInvalidEmailFormat(String invalidEmail) {
    givenWithAllure()
        .basePath("/login")
        .body("{\"email\":\"" + invalidEmail + "\",\"password\":\"senha123\"}")
    .when()
        .post()
    .then()
        .statusCode(400)
        .body("email", notNullValue());
}
```

### Arquivo CSV utilizado no CT05

`src/test/resources/restassured/login/invalid-login-emails.csv`

```csv
invalidEmail
emailwithoutat
@noname.com
email@nodomain
email
12345@test.c
!@#$%
```

---

## ğŸ¯ Funcionalidades do Rest Assured

### 1. RequestSpecification reutilizÃ¡vel

```java
RequestSpecification requestSpec = new RequestSpecBuilder()
    .setBaseUri("https://serverest.dev")
    .setContentType(ContentType.JSON)
    .addFilter(new AllureRestAssured())
    .build();

given()
    .spec(requestSpec)
    .body(payload)
.when()
    .post("/login")
.then()
    .statusCode(200);
```

### 2. ExtraÃ§Ã£o de valores da resposta

```java
// Extrair campo simples
String token = response.path("authorization");

// Extrair com extract()
String token = given()
    .body(payload)
.when()
    .post("/login")
.then()
    .extract().path("authorization");

// Extrair response completa
Response response = given()
    .body(payload)
.when()
    .post("/login")
.then()
    .extract().response();
```

### 3. ValidaÃ§Ãµes com Hamcrest

```java
.then()
    .statusCode(200)
    // Igualdade
    .body("message", equalTo("Login realizado com sucesso"))
    // NÃ£o nulo
    .body("authorization", notNullValue())
    // Nulo
    .body("error", nullValue())
    // ContÃ©m string
    .body("message", containsString("sucesso"))
    // Lista nÃ£o vazia
    .body("usuarios", not(empty()))
    // Tamanho de lista
    .body("usuarios.size()", greaterThan(0));
```

### 4. VariÃ¡veis e ReutilizaÃ§Ã£o

```java
// Dados dinÃ¢micos com Faker
String email    = FakerUtils.randomEmail();
String name     = FakerUtils.randomName();
String product  = FakerUtils.randomProduct();

// Montar payload dinÃ¢mico
String payload = String.format(
    "{\"email\":\"%s\",\"password\":\"%s\"}", email, password
);

// Reutilizar token entre testes
String token = loginAndGetToken(email, password);
given().header("Authorization", token).when().get("/produtos");
```

### 5. Hooks e Setup com JUnit 5

```java
@TestInstance(Lifecycle.PER_CLASS)
@Execution(ExecutionMode.CONCURRENT)
public class LoginRestAssuredTest extends BaseApiTest {

    @BeforeAll
    void init() {
        RestAssured.baseURI = "https://serverest.dev";
    }

    @BeforeEach
    void beforeEach(TestInfo testInfo) {
        System.out.println("Executando: " + testInfo.getDisplayName());
    }
}
```

---

## ğŸ“Š RelatÃ³rios

ApÃ³s executar os testes, relatÃ³rios Allure sÃ£o gerados automaticamente:

```
target/allure-report/index.html
```

Para gerar e abrir o relatÃ³rio localmente:

```bash
mvn allure:serve
```

O relatÃ³rio exibe:
- âœ… Testes executados, passados e falhos
- â±ï¸ Tempo de execuÃ§Ã£o por teste
- ğŸ“‹ Logs detalhados de request/response
- ğŸ“Š GrÃ¡ficos de cobertura e histÃ³rico de execuÃ§Ãµes

---

## ğŸ“ Boas PrÃ¡ticas

### 1. OrganizaÃ§Ã£o das Classes de Teste

- âœ… Uma classe por recurso (`LoginRestAssuredTest`, `UsuariosRestAssuredTest`)
- âœ… Use `BaseApiTest` para configuraÃ§Ãµes comuns
- âœ… Nomeie os mÃ©todos de forma descritiva com prefixo `ct0X_`

### 2. AnotaÃ§Ãµes para OrganizaÃ§Ã£o

```java
@Tag("smoke")       // Testes crÃ­ticos de smoke
@Tag("regression")  // Suite de regressÃ£o completa
@Tag("login")       // Testes de login
@Disabled           // Temporariamente desabilitado
```

### 3. ReutilizaÃ§Ã£o de CÃ³digo

- âœ… Crie mÃ©todos helper (ex: `loginAndGetToken()`, `createUser()`)
- âœ… Use `RequestSpecification` para configuraÃ§Ãµes comuns
- âœ… Centralize constantes em classes utilitÃ¡rias

### 4. Dados de Teste

```java
// Sempre use dados dinÃ¢micos para evitar conflitos
String email    = FakerUtils.randomEmail();
String product  = FakerUtils.randomProduct() + System.currentTimeMillis();

// Evite dados estÃ¡ticos hardcoded que podem causar conflitos
```

### 5. ValidaÃ§Ãµes Completas

```java
// Sempre valide:
.statusCode(200)                             // Status code
.body("message", equalTo("..."))             // Mensagem de resposta
.body("authorization", notNullValue())       // Campos obrigatÃ³rios
.header("Content-Type", containsString("application/json")) // Headers
```

---

## ğŸ“š Recursos Adicionais

### DocumentaÃ§Ã£o Oficial

- ğŸ§ª **Rest Assured**: https://rest-assured.io/
- ğŸŒ **ServeRest**: https://serverest.dev/
- â˜• **JUnit 5**: https://junit.org/junit5/
- ğŸ“Š **Allure**: https://docs.qameta.io/allure/

### Tutoriais e Cursos

- [Rest Assured Official Documentation](https://github.com/rest-assured/rest-assured/wiki/Usage)
- [Hamcrest Matchers](http://hamcrest.org/JavaHamcrest/javadoc/2.2/)
- [ServeRest GitHub](https://github.com/ServeRest/ServeRest)

### Comunidade

- [Stack Overflow - Rest Assured Tag](https://stackoverflow.com/questions/tagged/rest-assured)
- [Rest Assured GitHub Issues](https://github.com/rest-assured/rest-assured/issues)

---

## ğŸ¤ Contribuindo

ContribuiÃ§Ãµes sÃ£o bem-vindas! Para contribuir:

1. Fork o projeto
2. Crie uma branch para sua feature (`git checkout -b feature/MinhaFeature`)
3. Commit suas mudanÃ§as (`git commit -m 'Adiciona nova feature'`)
4. Push para a branch (`git push origin feature/MinhaFeature`)
5. Abra um Pull Request

---

## ğŸ“„ LicenÃ§a

Este projeto estÃ¡ sob a licenÃ§a MIT. Veja o arquivo [LICENSE](LICENSE) para mais detalhes.

---

## ğŸ‘¨â€ğŸ’» Autor

Desenvolvido para fins de estudo e prÃ¡tica de automaÃ§Ã£o de testes de API.

---

## â­ Agradecimentos

- **Paulo GonÃ§alves** - Criador da API ServeRest
- **Johan Haleby** - Criador do Rest Assured
- Comunidade open-source

---

ReferÃªncias:
- https://rest-assured.io/
- https://junit.org/junit5/
- https://github.com/rest-assured/rest-assured/wiki/Usage

**ğŸš€ Happy Testing!** ğŸ§ª